"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EffectFactory = void 0;
const utils_1 = require("../../+internal/utils");
const error_factory_1 = require("../../error/error.factory");
const http_interface_1 = require("../http.interface");
const httpMethods = utils_1.getArrayFromEnum(http_interface_1.HttpMethodType);
const coreErrorOptions = { contextMethod: 'EffectFactory' };
/**
 * @deprecated since version 3.0, use pipable builder instead
 *
 * #EffectFactory will be deleted in the next major version (v4.0),
 */
exports.EffectFactory = {
    matchPath: (path) => {
        if (!path) {
            throw error_factory_1.coreErrorFactory('Path cannot be empty', coreErrorOptions);
        }
        return { matchType: exports.EffectFactory.matchType(path) };
    },
    matchType: (path) => (method) => {
        if (!method) {
            throw error_factory_1.coreErrorFactory('HttpMethod needs to be defined', coreErrorOptions);
        }
        if (!httpMethods.includes(method)) {
            throw error_factory_1.coreErrorFactory(`HttpMethod needs to be one of the following: ${httpMethods}`, coreErrorOptions);
        }
        return { use: exports.EffectFactory.use(path)(method) };
    },
    use: (path) => (method) => (effect) => {
        if (!effect) {
            throw error_factory_1.coreErrorFactory('Effect needs to be provided', coreErrorOptions);
        }
        return { path, method, effect };
    },
};
