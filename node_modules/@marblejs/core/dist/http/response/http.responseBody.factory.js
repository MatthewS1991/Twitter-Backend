"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.bodyFactory = void 0;
const util_1 = require("util");
const pipeable_1 = require("fp-ts/lib/pipeable");
const http_1 = require("../../+internal/http");
const utils_1 = require("../../+internal/utils");
exports.bodyFactory = headers => body => {
    const contentType = http_1.getContentType(headers);
    if (utils_1.isStream(body))
        return body;
    if (http_1.isJsonContentType(contentType))
        return utils_1.stringifyJson(body);
    switch (contentType) {
        case http_1.ContentType.APPLICATION_X_WWW_FORM_URLENCODED:
            return utils_1.transformUrlEncoded(body);
        case http_1.ContentType.APPLICATION_OCTET_STREAM:
            return !util_1.isBuffer(body)
                ? pipeable_1.pipe(body, utils_1.stringifyJson, utils_1.bufferFrom)
                : body;
        case http_1.ContentType.TEXT_PLAIN:
            return String(body);
        default:
            return body;
    }
};
